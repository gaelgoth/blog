import{s as pt,a as Ee,e as et,n as dt}from"../chunks/scheduler.FGUOCI5T.js";import{S as ct,i as ht,k as xe,l as be,m as Te,n as ke,o as Ce,p as He,e as a,s as i,t as De,H as tt,c as n,q as r,f as o,a as st,b as _e,d as s,r as lt,u as v,g as l,h as K}from"../chunks/index.DPb7ZaWV.js";import{P as ft,g as ut,a as at}from"../chunks/post_layout.C2tSXcAq.js";import{I as nt}from"../chunks/footer.BMJ1WMWW.js";function Ft(j){let p,g="<p>Picture: Gaël G.</p>",u,c,d='<a href="#introduction">Introduction</a>',h,F,Le='A friend of mine told me how he missed out on a fantastic offer on a gaming monitor he really wanted. Then, he wondered if there was a platform that collected the deals of the day on the online stores that do it. We can mention the website <a href="https://www.piratesdesprix.ch/" rel="nofollow noopener noreferrer external" target="_blank">piratesdesprix.ch</a> which lists different deals from several shops. However, they did not have the stores we were interested in, namely <strong>QoQa</strong>, <strong>Digitec</strong> and <strong>Galaxus</strong>. It is from here that I had the idea to create a small service that aggregates the deals of the day!',Z,m,Me='<div><span class="text-lg i-simple-icons-github !w-5 !h-5"></span> <div><a href="https://github.com/gaelgoth/swiss-deals-api"><h3 class="font-bold my-0">gaelgoth/swiss-deals-api</h3></a> <div class="text-xs">Aggregate deals of the day from Digitec, Galaxus, QoQa</div></div></div>',J,y,Pe='<a href="#building-api-with-golang">Building API with Golang</a>',V,k,qe="Used to create backend in Python or TypeScript/JavaScript, this is a good opportunity for me to try Golang. Before we start coding the API, we need to figure out how to get the information we need. Then we will set up the Go dev environnement. Finally, we will be able to retrieve data from <strong>QoQa</strong>, <strong>Digitec</strong> and <strong>Galaxus</strong>.",X,w,Ie='<a href="#retrieve-data">Retrieve data</a>',Y,C,$e="Let’s do some reverse engineering to find the best way to get the information about the offer of the day.",ee,f,me,B,Ae="QoQa",ye,R,Ge="http",we,H,te,L,Qe="Basically, we found out that the following Request URL give use the deals: <code>https://api.qoqa.ch/v2/websites/wwwqoqach/offer_preview</code>. The <code>wwwqoqach</code> identifier can be retrieved from the following endpoint: <code>https://api.qoqa.ch/v2/websites</code>",se,z,ot=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #546E7A"># get identifiers list</span></div><div class='line'><span style="color: #EEFFFF">curl https://api.qoqa.ch/v2/websites </span><span style="color: #89DDFF">|</span><span style="color: #EEFFFF"> jq</span></div><div class='line'></div><div class='line'><span style="color: #546E7A"># get current deals by replacing &lt;identifier&gt;</span></div><div class='line'><span style="color: #EEFFFF">curl https://api.qoqa.ch/v2/websites/</span><span style="color: #89DDFF">&lt;</span><span style="color: #EEFFFF">identifier</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF">/offer_preview</span></div></code></div></pre>`,O,M,Se='Unfortunately for Digitec and co, this is a different matter. The offer of the day is displayed via several GraphQL queries. I am not very familiar with GraphQL, so for Digitec the idea is to scrape the <a href="https://www.digitec.ch/fr/liveshopping/81" rel="nofollow noopener noreferrer external" target="_blank">page</a> that gives us the offer of the day.',le,D,je='<a href="#golang-frameworks">Golang frameworks</a>',ae,P,Be='In a nutshell, we require web frameworks that support HTTP methods and HTML scraping in order to build this API. <a href="https://deals-api.gothuey.dev/" rel="nofollow noopener noreferrer external" target="_blank">Swiss Deals API</a> will based on <a href="https://github.com/gofiber/fiber" rel="nofollow noopener noreferrer external" target="_blank">Fiber</a> that is an <a href="https://expressjs.com/" rel="nofollow noopener noreferrer external" target="_blank">Express</a> inspired web framework written in Go. We’ll utilize <a href="https://github.com/gocolly/colly" rel="nofollow noopener noreferrer external" target="_blank">Coly</a>, an elegant scraper and crawler framework for Golang, to extract web site content. To power this API other <a href="https://github.com/gaelgoth/swiss-deals-api/blob/4d95d7477ddd8176541f05d7a77dafd3f1320ccb/main.go#L3-L17" rel="nofollow noopener noreferrer external" target="_blank">sub-tools</a> are exploited for swagger documentation, query caching and logging.',ne,U,q,ie,_,Re='<a href="#environnement">Environnement</a>',oe,I,Ue="The development environment with Golang is relatively easy to set up. I tested several alternatives:",re,$,ze='<li><strong>Makefile</strong>: The startup task runs the command <code>go run main.go</code> and writes its process ID to PID_FILE.</li> <li><strong>Docker-compose.dev</strong>: Run the Golang build inside a container coupled with <a href="https://github.com/cosmtrek/air" rel="nofollow noopener noreferrer external" target="_blank">Air</a> for hot reloading when editing the code from IDE</li> <li><strong>Air</strong> (the easiest one): As described by his creator, just <code>air</code> command in your project root directory, leave it alone, and focus on your code.</li>',pe,A,Oe='Everything is ready, let’s see what <a href="https://deals-api.gothuey.dev/" rel="nofollow noopener noreferrer external" target="_blank">Swiss Deals API</a> can accomplish after a few hours of code.',de,E,Ne='<a href="#demo">Demo</a>',ce,G,We="At the time of writing, the API serves two groups of endpoints, “QoQa” and “Digitec”.",he,N,rt=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">$ curl https://deals-api.gothuey.dev/api/deals/digitec </span><span style="color: #89DDFF">|</span><span style="color: #EEFFFF"> jq</span></div><div class='line'><span style="color: #EEFFFF">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></div><div class='line'><span style="color: #EEFFFF">                                 Dload  Upload   Total   Spent    Left  Speed</span></div><div class='line'><span style="color: #EEFFFF">100   389  100   389    0     0    805      0 --:--:-- --:--:-- --:--:--   805</span></div><div class='line'><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">store</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">: </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Digitec</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">,</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">title</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">: </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Netgear RBK353 Orbi WiFi 6 Dual Band set de 3</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">,</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">url</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">: </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">https://www.digitec.ch/liveshopping/</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">,</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">remaining_stock</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">: 61,</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">stock</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">: 150,</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">offer_price</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">: 179,</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">regular_price</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">: 267,</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">image_url</span><span style="color: #89DDFF">"</span><span style="color: #EEFFFF">: </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">https://www.digitec.ch/im/files/...</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #89DDFF">&#125;</span></div></code></div></pre>`,W,Q,Ke='You can interact with <a href="https://deals-api.gothuey.dev/" rel="nofollow noopener noreferrer external" target="_blank">Swiss Deals API</a> by consulting the Swagger documentation on <a href="https://deals-api.gothuey.dev/swagger/index.html" rel="nofollow noopener noreferrer external" target="_blank">https://deals-api.gothuey.dev/swagger/index.html</a>.',fe,x,Ze='<a href="#final-thoughts">Final thoughts</a>',ue,S,Je="I was able to learn Golang programming through this short project. Along with improving the quality of the code, my goal is to increase the variety of offers the API returns.",Fe,b,Ve='<a href="#next-steps">Next steps</a>',ve,T,Xe='<li class="task-list-item"><input type="checkbox" checked="" disabled=""/> Set up a frontend to make access to deals more welcoming</li> <li class="task-list-item"><input type="checkbox" disabled=""/> Improve errors handling</li> <li class="task-list-item"><input type="checkbox" disabled=""/> Add deals from other online stores<ul class="contains-task-list"><li class="task-list-item"><input type="checkbox" disabled=""/> piratesdesprix.ch</li> <li class="task-list-item"><input type="checkbox" disabled=""/> steg-electronics.ch</li> <li class="task-list-item"><input type="checkbox" disabled=""/> microspot.ch</li> <li class="task-list-item"><input type="checkbox" disabled=""/> …</li></ul></li>',ge;return H=new nt({props:{src:"/2022/swiss-deals-api/qoqa-http-product.webp",alt:"Get http deal from QoQa",title:"Get http traffic"}}),q=new nt({props:{src:"/2022/swiss-deals-api/swiss-deals-diagramm.svg",alt:"How Swiss deals will work"}}),{c(){p=a("blockquote"),p.innerHTML=g,u=i(),c=a("h2"),c.innerHTML=d,h=i(),F=a("p"),F.innerHTML=Le,Z=i(),m=a("div"),m.innerHTML=Me,J=i(),y=a("h2"),y.innerHTML=Pe,V=i(),k=a("p"),k.innerHTML=qe,X=i(),w=a("h3"),w.innerHTML=Ie,Y=i(),C=a("p"),C.textContent=$e,ee=i(),f=a("p"),me=De("Let’s get started with "),B=a("strong"),B.textContent=Ae,ye=De(". By analyzing the traffic when we load the page, we can easily notice the "),R=a("code"),R.textContent=Ge,we=De(` request that serves us the promotion of the day.
`),xe(H.$$.fragment),te=i(),L=a("p"),L.innerHTML=Qe,se=i(),z=new tt(!1),O=i(),M=a("p"),M.innerHTML=Se,le=i(),D=a("h3"),D.innerHTML=je,ae=i(),P=a("p"),P.innerHTML=Be,ne=i(),U=a("p"),xe(q.$$.fragment),ie=i(),_=a("h3"),_.innerHTML=Re,oe=i(),I=a("p"),I.textContent=Ue,re=i(),$=a("ul"),$.innerHTML=ze,pe=i(),A=a("p"),A.innerHTML=Oe,de=i(),E=a("h2"),E.innerHTML=Ne,ce=i(),G=a("p"),G.textContent=We,he=i(),N=new tt(!1),W=i(),Q=a("p"),Q.innerHTML=Ke,fe=i(),x=a("h2"),x.innerHTML=Ze,ue=i(),S=a("p"),S.textContent=Je,Fe=i(),b=a("h2"),b.innerHTML=Ve,ve=i(),T=a("ul"),T.innerHTML=Xe,this.h()},l(e){p=n(e,"BLOCKQUOTE",{"data-svelte-h":!0}),r(p)!=="svelte-1mdymf7"&&(p.innerHTML=g),u=o(e),c=n(e,"H2",{id:!0,"data-svelte-h":!0}),r(c)!=="svelte-ccveyw"&&(c.innerHTML=d),h=o(e),F=n(e,"P",{"data-svelte-h":!0}),r(F)!=="svelte-1x83gf8"&&(F.innerHTML=Le),Z=o(e),m=n(e,"DIV",{class:!0,"data-svelte-h":!0}),r(m)!=="svelte-705foz"&&(m.innerHTML=Me),J=o(e),y=n(e,"H2",{id:!0,"data-svelte-h":!0}),r(y)!=="svelte-19l9l3y"&&(y.innerHTML=Pe),V=o(e),k=n(e,"P",{"data-svelte-h":!0}),r(k)!=="svelte-14m7h0t"&&(k.innerHTML=qe),X=o(e),w=n(e,"H3",{id:!0,"data-svelte-h":!0}),r(w)!=="svelte-cnelg2"&&(w.innerHTML=Ie),Y=o(e),C=n(e,"P",{"data-svelte-h":!0}),r(C)!=="svelte-jzi3pt"&&(C.textContent=$e),ee=o(e),f=n(e,"P",{});var t=st(f);me=_e(t,"Let’s get started with "),B=n(t,"STRONG",{"data-svelte-h":!0}),r(B)!=="svelte-1q6601m"&&(B.textContent=Ae),ye=_e(t,". By analyzing the traffic when we load the page, we can easily notice the "),R=n(t,"CODE",{"data-svelte-h":!0}),r(R)!=="svelte-znbjfg"&&(R.textContent=Ge),we=_e(t,` request that serves us the promotion of the day.
`),be(H.$$.fragment,t),t.forEach(s),te=o(e),L=n(e,"P",{"data-svelte-h":!0}),r(L)!=="svelte-dmyvvl"&&(L.innerHTML=Qe),se=o(e),z=lt(e,!1),O=o(e),M=n(e,"P",{"data-svelte-h":!0}),r(M)!=="svelte-870swl"&&(M.innerHTML=Se),le=o(e),D=n(e,"H3",{id:!0,"data-svelte-h":!0}),r(D)!=="svelte-qcfm85"&&(D.innerHTML=je),ae=o(e),P=n(e,"P",{"data-svelte-h":!0}),r(P)!=="svelte-5vrki4"&&(P.innerHTML=Be),ne=o(e),U=n(e,"P",{});var Ye=st(U);be(q.$$.fragment,Ye),Ye.forEach(s),ie=o(e),_=n(e,"H3",{id:!0,"data-svelte-h":!0}),r(_)!=="svelte-1jie8ts"&&(_.innerHTML=Re),oe=o(e),I=n(e,"P",{"data-svelte-h":!0}),r(I)!=="svelte-u1k7oa"&&(I.textContent=Ue),re=o(e),$=n(e,"UL",{"data-svelte-h":!0}),r($)!=="svelte-1rc2978"&&($.innerHTML=ze),pe=o(e),A=n(e,"P",{"data-svelte-h":!0}),r(A)!=="svelte-ty4g2s"&&(A.innerHTML=Oe),de=o(e),E=n(e,"H2",{id:!0,"data-svelte-h":!0}),r(E)!=="svelte-18ssa5v"&&(E.innerHTML=Ne),ce=o(e),G=n(e,"P",{"data-svelte-h":!0}),r(G)!=="svelte-1x8wwde"&&(G.textContent=We),he=o(e),N=lt(e,!1),W=o(e),Q=n(e,"P",{"data-svelte-h":!0}),r(Q)!=="svelte-6pc6u6"&&(Q.innerHTML=Ke),fe=o(e),x=n(e,"H2",{id:!0,"data-svelte-h":!0}),r(x)!=="svelte-2qh8hi"&&(x.innerHTML=Ze),ue=o(e),S=n(e,"P",{"data-svelte-h":!0}),r(S)!=="svelte-18uouji"&&(S.textContent=Je),Fe=o(e),b=n(e,"H2",{id:!0,"data-svelte-h":!0}),r(b)!=="svelte-1fvwda2"&&(b.innerHTML=Ve),ve=o(e),T=n(e,"UL",{class:!0,"data-svelte-h":!0}),r(T)!=="svelte-1y923uj"&&(T.innerHTML=Xe),this.h()},h(){v(c,"id","introduction"),v(m,"class","alert shadow-inner"),v(y,"id","building-api-with-golang"),v(w,"id","retrieve-data"),z.a=O,v(D,"id","golang-frameworks"),v(_,"id","environnement"),v(E,"id","demo"),N.a=W,v(x,"id","final-thoughts"),v(b,"id","next-steps"),v(T,"class","contains-task-list")},m(e,t){l(e,p,t),l(e,u,t),l(e,c,t),l(e,h,t),l(e,F,t),l(e,Z,t),l(e,m,t),l(e,J,t),l(e,y,t),l(e,V,t),l(e,k,t),l(e,X,t),l(e,w,t),l(e,Y,t),l(e,C,t),l(e,ee,t),l(e,f,t),K(f,me),K(f,B),K(f,ye),K(f,R),K(f,we),Te(H,f,null),l(e,te,t),l(e,L,t),l(e,se,t),z.m(ot,e,t),l(e,O,t),l(e,M,t),l(e,le,t),l(e,D,t),l(e,ae,t),l(e,P,t),l(e,ne,t),l(e,U,t),Te(q,U,null),l(e,ie,t),l(e,_,t),l(e,oe,t),l(e,I,t),l(e,re,t),l(e,$,t),l(e,pe,t),l(e,A,t),l(e,de,t),l(e,E,t),l(e,ce,t),l(e,G,t),l(e,he,t),N.m(rt,e,t),l(e,W,t),l(e,Q,t),l(e,fe,t),l(e,x,t),l(e,ue,t),l(e,S,t),l(e,Fe,t),l(e,b,t),l(e,ve,t),l(e,T,t),ge=!0},p:dt,i(e){ge||(ke(H.$$.fragment,e),ke(q.$$.fragment,e),ge=!0)},o(e){Ce(H.$$.fragment,e),Ce(q.$$.fragment,e),ge=!1},d(e){e&&(s(p),s(u),s(c),s(h),s(F),s(Z),s(m),s(J),s(y),s(V),s(k),s(X),s(w),s(Y),s(C),s(ee),s(f),s(te),s(L),s(se),z.d(),s(O),s(M),s(le),s(D),s(ae),s(P),s(ne),s(U),s(ie),s(_),s(oe),s(I),s(re),s($),s(pe),s(A),s(de),s(E),s(ce),s(G),s(he),N.d(),s(W),s(Q),s(fe),s(x),s(ue),s(S),s(Fe),s(b),s(ve),s(T)),He(H),He(q)}}}function vt(j){let p,g;const u=[j[0],it];let c={$$slots:{default:[Ft]},$$scope:{ctx:j}};for(let d=0;d<u.length;d+=1)c=Ee(c,u[d]);return p=new ft({props:c}),{c(){xe(p.$$.fragment)},l(d){be(p.$$.fragment,d)},m(d,h){Te(p,d,h),g=!0},p(d,[h]){const F=h&1?ut(u,[h&1&&at(d[0]),h&0&&at(it)]):{};h&2&&(F.$$scope={dirty:h,ctx:d}),p.$set(F)},i(d){g||(ke(p.$$.fragment,d),g=!0)},o(d){Ce(p.$$.fragment,d),g=!1},d(d){He(p,d)}}}const it={title:"Swiss deals API",image:"/2022/swiss-deals-api/swiss-deals-api-bg.webp",summary:"An API that aggregates the offers of the day",created:"2022-10-20T00:00:00.000Z",tags:["API","Go"],updated:"2025-01-25T23:43:32.791Z",images:[],slug:"/2022/swiss-deals-api/+page.svelte.md",path:"/2022/swiss-deals-api",toc:[{depth:2,title:"Introduction",slug:"introduction"},{depth:2,title:"Building API with Golang",slug:"building-api-with-golang"},{depth:3,title:"Retrieve data",slug:"retrieve-data"},{depth:3,title:"Golang frameworks",slug:"golang-frameworks"},{depth:3,title:"Environnement",slug:"environnement"},{depth:2,title:"Demo",slug:"demo"},{depth:2,title:"Final thoughts",slug:"final-thoughts"},{depth:2,title:"Next steps",slug:"next-steps"}]};function gt(j,p,g){return j.$$set=u=>{g(0,p=Ee(Ee({},p),et(u)))},p=et(p),[p]}class _t extends ct{constructor(p){super(),ht(this,p,gt,vt,pt,{})}}export{_t as component};
